{"ast":null,"code":"import{useEffect,useState,useRef}from\"react\";import\"./index.css\";import Three from\"./3D/ThreeJS\";import UI from\"./components/ui\";import{jsx as _jsx}from\"react/jsx-runtime\";const oscCount=6;export default function View(_ref){let{patchConnection}=_ref;const[stateLoaded,setStateLoaded]=useState(false);const[fftData,setFFTData]=useState([]);const[amps,setAmps]=useState(Array(oscCount).fill(0.0));const[frqs,setFrqs]=useState(Array(oscCount).fill(0.0));const[cons,setCons]=useState(Array(oscCount).fill(0));const updateValues=(type,index,value)=>{if(type===\"amp\"){setAmps(prev=>prev.map((amp,i)=>i===index?value:amp));}else if(type===\"frq\"){setFrqs(prev=>prev.map((frq,i)=>i===index?value:frq));}else if(type===\"con\"){// setCons((prev) => prev.map((con, i) => (i === index ? value : con)));\n}};const handleSliderChange=(type,index,value)=>{updateValues(type,index,value);patchConnection===null||patchConnection===void 0?void 0:patchConnection.sendEventOrValue(\"\".concat(type,\"Band\").concat(index),value,100);};const handleControlChange=(type,index,value)=>{// setAmps((prev) => prev.map((amp, i) => (i === index ? value : amp)));\nupdateValues(type,index,value);patchConnection===null||patchConnection===void 0?void 0:patchConnection.sendEventOrValue(\"osc\".concat(index,\"_\").concat(type),value);console.log(type,index,value);};const handleDftOut=event=>{setFFTData(event.magnitudes);};useEffect(()=>{const requestParameterValues=type=>{for(let i=0;i<oscCount;i++){patchConnection===null||patchConnection===void 0?void 0:patchConnection.requestParameterValue(\"osc\".concat(i,\"_\").concat(type));}};const handleControlChange=event=>{const id=event.endpointID;const val=event.value;const index=parseInt(id.slice(3,4));const type=id.slice(5,8);// updateValues(\"amp\", 1, 0.5);\nupdateValues(type,index,val);};// Add listeners for DFT output and input controls\npatchConnection===null||patchConnection===void 0?void 0:patchConnection.addEndpointListener(\"dftOut\",handleDftOut);patchConnection===null||patchConnection===void 0?void 0:patchConnection.addAllParameterListener(handleControlChange);// Load initial state\nif(!stateLoaded){requestParameterValues(\"amp\");requestParameterValues(\"frq\");requestParameterValues(\"con\");setStateLoaded(true);}return()=>{patchConnection===null||patchConnection===void 0?void 0:patchConnection.removeEndpointListener(\"dftOut\",handleDftOut);patchConnection===null||patchConnection===void 0?void 0:patchConnection.removeAllParameterListener(handleControlChange);};},[patchConnection,stateLoaded]);return/*#__PURE__*/_jsx(\"div\",{className:\"containerWrapper\",children:/*#__PURE__*/_jsx(UI,{amps:amps,frqs:frqs,cons:cons,handleControlChange:handleControlChange})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}